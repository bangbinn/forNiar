<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Happy Birthday</title>
  <style>
    /* Reset & Base */
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Poppins", sans-serif; }
    html, body { height: 100%; -webkit-text-size-adjust: 100%; touch-action: manipulation; }

    body {
      background: linear-gradient(135deg, #ffdde1, #ee9ca7);
      display: flex; justify-content: center; align-items: center;
      height: 100vh; overflow: hidden; text-align: center; padding: 20px;
      position: relative;
    }

    /* Container */
    .container {
      width: 90%; max-width: 600px; min-height: 400px;
      padding: 40px 30px 100px; border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.2);
      background: linear-gradient(180deg, #fff, #ffe6f7);
      border: 3px solid #ff7bbf;
      opacity: 0; transform: scale(0.9);
      animation: fadeScaleIn 0.6s ease forwards;
      display: flex; flex-direction: column; justify-content: flex-start;
      position: relative; z-index: 1;
      text-align: center;
    }

    /* Animations */
    @keyframes fadeScaleIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    @keyframes fadeOut { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.9); } }

    /* Text */
    h2 { font-size: clamp(26px, 5vw, 38px); margin-bottom: 20px; color: #ff4d88; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); text-align: center; }
    p { font-size: clamp(18px, 4vw, 22px); margin-bottom: 30px; color: #444; line-height: 1.6; text-align: center; }

    /* Buttons */
    #buttons { position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); }
    button {
      padding: 16px 36px; border: none; border-radius: 12px;
      background: linear-gradient(135deg, #ff7bbf, #ff4d88);
      color: white; cursor: pointer; font-size: 16px; font-weight: 600;
      transition: 0.25s; box-shadow: 0 6px 14px rgba(255,77,136,0.25);
      margin: 10px; touch-action: manipulation;
    }
    button:hover { transform: translateY(-3px); }

    /* Canvas Confetti */
    canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2; }

    /* Chibi Animation */
    .chibi-anim { position: absolute; bottom: 10px; right: 10px; width: 150px; height: auto; z-index: 3; transition: transform 0.6s ease; }
    .chibi-move { transform: translateY(-30px) rotate(10deg) scale(1.1); }

    /* Tambahan gambar */
    .extra-img-2 {
      position: absolute; bottom: 10px; left: 10px; width: 140px; height: auto; z-index: 2; pointer-events: none;
    }
    .extra-img-3 {
      position: absolute; bottom: 0; right: 20px; width: 220px; height: auto; z-index: 2; pointer-events: none;
    }
    .extra-img-4 {
      position: absolute; bottom: 0; left: 10px; width: 180px; height: auto; z-index: 2; pointer-events: none;
    }

    /* Responsive */
    @media (max-width: 480px) {
      .container { max-width: 95%; min-height: 360px; padding: 30px 20px 80px; border-radius: 18px; }
      h2 { font-size: 24px; } p { font-size: 16px; }
      button { padding: 14px 24px; font-size: 14px; }
      .chibi-anim { width: 110px; }
      .extra-img-2 { width: 100px; }
      .extra-img-3 { width: 160px; bottom: 0; right: 15px; }
      .extra-img-4 { width: 120px; bottom: 0; left: 5px; }
    }
  </style>
</head>
<body>
  <canvas id="confettiCanvas"></canvas>
  <div class="container" id="card">
    <h2 id="title">ðŸŽ€Happy BirthdayðŸŽ€</h2>
    <p id="message">25 tahun bukan hanya angka, tapi cerminan dari segala perjuangan, mimpi, dan doa yang sudah kamu jalani. Semoga tahun ini menjadi awal dari banyak keajaiban baru dalam hidupmuðŸ’•</p>
    <div id="buttons">
      <button onclick="nextPage(2)">Next âžœ</button>
    </div>

    <!-- Tambahan gambar di card kedua -->
    <img src="https://i.ibb.co/p6cJwdKr/sample-image2.png" alt="Gambar Ekstra 2" class="extra-img-2" id="extraImg2" style="display:none;" referrerpolicy="no-referrer" loading="lazy">

    <!-- Gambar card pertama (dulu card ke-3) -->
    <img src="https://i.ibb.co/gbMZjSYB/sample-image3.png" alt="Gambar Ekstra 3" class="extra-img-3" id="extraImg3" style="display:block;" referrerpolicy="no-referrer" loading="lazy">

    <!-- Gambar baru di card ke-3 -->
    <img src="" data-ibb-id="4ZSjBB9b" alt="Gambar Ekstra 4" class="extra-img-4" id="extraImg4" style="display:none;" referrerpolicy="no-referrer" loading="lazy">

    <img src="https://i.ibb.co/jP1tQGp6/chibi.gif" alt="Chibi Animasi" class="chibi-anim" id="chibiAnim" style="display:none;">
  </div>

  <script>
    const card = document.getElementById('card');
    const chibiAnim = document.getElementById('chibiAnim');
    const extraImg2 = document.getElementById('extraImg2');
    const extraImg3 = document.getElementById('extraImg3');
    const extraImg4 = document.getElementById('extraImg4');

    const pages = [
      { title: "ðŸŽ€ Selamat Ulang Tahun ðŸŽ€", message: "Semoga harimu penuh warna pastel, tawa manis, dan vibes estetik ala Gen Z ðŸ’•", buttons: '<button onclick="nextPage(2)">Next âžœ</button>', showExtra3: true },
      { title: "ðŸŒ¸ Harapan Manis ðŸŒ¸", message: "Semoga semua impianmu jadi nyata, kayak aesthetic feed IG yang goals banget âœ¨", buttons: '<button onclick="nextPage(3)">Next âžœ</button>', showExtra2: true },
      { title: "ðŸ’– Stay Happy ðŸ’–", message: "Jangan lupa self-love & healing vibes setiap hari, kamu deserve yang terbaik ðŸ’«", buttons: '<button onclick="nextPage(4)">Next âžœ</button>', showExtra4: true },
      { title: "âœ¨ Glow Up âœ¨", message: "Semoga tahun ini penuh dengan glow up, cinta, dan petualangan seru ðŸŒˆ", buttons: '<button onclick="startCelebration()">ðŸ˜­ Rayakan</button> <button onclick="nextPage(1)">ðŸ”„ Ulangi Lagi</button>', showChibi: true }
    ];

    function nextPage(page) {
      card.style.animation = 'fadeOut 0.4s ease forwards';
      setTimeout(() => {
        const data = pages[page-1];
        document.getElementById('title').innerText = data.title;
        document.getElementById('message').innerText = data.message;
        document.getElementById('buttons').innerHTML = data.buttons;
        card.style.animation = 'fadeScaleIn 0.6s ease forwards';
        chibiAnim.style.display = data.showChibi ? 'block' : 'none';
        extraImg2.style.display = data.showExtra2 ? 'block' : 'none';
        extraImg3.style.display = data.showExtra3 ? 'block' : 'none';
        extraImg4.style.display = data.showExtra4 ? 'block' : 'none';
      }, 400);
    }

    // ==== Perbaikan pemuatan gambar imgbb dengan hanya ID ====
    // Beberapa link yang diberikan berupa halaman (ibb.co.com/ID). Kita coba resolve otomatis
    // ke domain CDN (i.ibb.co/ID/<nama-bebas>.<ext>) dengan beberapa ekstensi umum.
    function resolveImgbbById(imgEl, id) {
      if (!imgEl) return;
      const exts = ['png','jpg','jpeg','gif','webp'];
      const names = ['image','img','photo','pic',id,'file'];
      let i = 0;
      function tryNext() {
        if (i >= exts.length * names.length) {
          console.warn('Gagal memuat dari i.ibb.co untuk ID:', id);
          // Fallback placeholder agar layout tetap rapi
          imgEl.src = 'data:image/svg+xml;utf8,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="180" height="120"><rect width="100%" height="100%" fill="#ffe6f7"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="#ff4d88" font-family="Poppins, sans-serif" font-size="14">Gambar tidak ditemukan</text></svg>');
          return;
        }
        const name = names[i % names.length];
        const ext = exts[Math.floor(i / names.length) % exts.length];
        const url = `https://i.ibb.co/${id}/${name}.${ext}`;
        i++;
        const test = new Image();
        test.onload = () => { imgEl.src = url; };
        test.onerror = tryNext;
        test.referrerPolicy = 'no-referrer';
        test.src = url;
      }
      tryNext();
    }

    // Jalankan saat DOM siap
    document.addEventListener('DOMContentLoaded', () => {
      const id = extraImg4.getAttribute('data-ibb-id');
      if (id) resolveImgbbById(extraImg4, id);
    });

    // ==== Confetti ====
    const canvas = document.getElementById('confettiCanvas');
    const ctx = canvas.getContext('2d');
    let particles = [], sideBursts = [], animationFrameId;

    function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.addEventListener('resize', resizeCanvas); resizeCanvas();
    function random(min, max) { return Math.random() * (max - min) + min; }

    function createTopConfetti() {
      for (let i = 0; i < 100; i++) {
        particles.push({ x: random(0, canvas.width), y: -20, size: random(16, 28), speedY: random(2, 4), text: "ðŸ˜­", opacity: 1 });
      }
    }

    function createSideBursts() {
      const colors = ["#ff4d88", "#ffcc00", "#66ccff", "#77dd77", "#ff7bbf"];
      for (let i = 0; i < 150; i++) {
        const fromLeft = Math.random() < 0.5;
        sideBursts.push({ x: fromLeft ? -20 : canvas.width+20, y: random(canvas.height/4, (3*canvas.height)/4), size: random(6, 12), speedX: fromLeft ? random(5,9) : -random(5,9), speedY: random(-2,2), color: colors[Math.floor(Math.random()*colors.length)], opacity: 1 });
      }
    }

    function drawParticles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let p of particles) { ctx.globalAlpha = p.opacity; ctx.font = "24px Poppins"; ctx.fillText(p.text, p.x, p.y); p.y += p.speedY; p.opacity -= 0.004; }
      for (let s of sideBursts) { ctx.globalAlpha = s.opacity; ctx.fillStyle = s.color; ctx.fillRect(s.x, s.y, s.size, s.size); s.x += s.speedX; s.y += s.speedY; s.opacity -= 0.01; }
      ctx.globalAlpha = 1;
      particles = particles.filter(p => p.opacity > 0 && p.y < canvas.height+50);
      sideBursts = sideBursts.filter(s => s.opacity > 0 && s.x > -50 && s.x < canvas.width+50);
      if (particles.length > 0 || sideBursts.length > 0) animationFrameId = requestAnimationFrame(drawParticles);
    }

    function startCelebration() {
      particles = []; sideBursts = [];
      createTopConfetti(); createSideBursts();
      cancelAnimationFrame(animationFrameId);
      drawParticles();
      if (chibiAnim.style.display === 'block') {
        chibiAnim.classList.add('chibi-move');
        setTimeout(() => chibiAnim.classList.remove('chibi-move'), 600);
      }
    }
  </script>
</body>
</html>

